# Java 基础知识

!!! info "导读"
    本节内容为`Java`基础知识整理，主要参考书籍为《Java核心技术·卷I》


## 概述

### Java关键特性
1. **简单性**：`C++`纯净版，没有指针、结构、联合等不适当的特性
2. 面向对象：对标`C++`
3. 分布式：处理网络请求
4. **健壮性**：编译及运行时检测，解决指针重写内存问题
5. 安全性：理论上不可信代码只会在沙盒中运行而不会影响主系统
6. **体系结构中立**：编译得到字节码，虚拟机解释执行。
7. 可移植性：明确规定数据类型的大小
8. 多线程：并发程序设计

### JVM & JDK & JRE
!!! info ""
    === "JVM"
        JVM（Java Virtual Machine）为 Java 虚拟机，可以运行Java字节码文件

    === "JDK"
        JDK（Java Development Kit）是一个完整的 Java 开发工具包，包含 JRE、Javac 以及其他工具

    === "JRE"
        JRE（Java Runtime Environment）为 Java 运行时环境，包含 JVM 和 Java 的基础类库
    
### JIT & AOT
!!! tip inline end "AOT"
    AOT（Ahead of Time Compilation），其在程序执行前就将其编译成机器码，属于静态编译，避免了 JIT 预热等开销，提高了
     Java 程序的启动速度。

!!! tip "JIT"
    JIT（Just In Time Compilation），即时编译器，会在编译后将字节码对应的文件保存下来供下次使用。JIT 聚焦于占较少部分
    的“热点代码”，这部分代码的使用频率较高，JIT 会根据每次代码的执行情况做出优化，理论上执行次数越多，速度越快。
    

!!! abstract "JIT vs AOT"
    JIT 拥有更高极限处理能力，AOT则有更快的启动速度和更小的内存占用，但是 AOT 编译无法支持 Java 的动态加载等特性。

### 命名规则
- 变量名：可以包含大小写字母、数字、下划线和`$`符号，不能以数字开头。同时`Java`采用`Unicode`编码，所以变量名可以使用各国的文字。
- Java 区分大小写，公共类名和文件名必须完全一致。

---

## 基本数据结构
`Java`共有8种基本类型，其中包括4种整型，2种浮点类型，1种字符类型和1种真值类型。

!!! important "Java 的数据结构都具有固定大小，与运行机器无关，"

### 基本数据类型

#### 整型
- `Java`提供四种整型：`int(4 bytes)`、`long(8 bytes)`、`short(2 bytes)`、`byte(1 byte)`。
- `long`类型后缀`L(l)`，十六进制前缀`0x(0X)`，八进制前缀`0`（所以十进制不得以零开头），二进制前缀`0b(0B)`
- `Java`允许为数字字面量添加下划线（如`1_000_000`），为了让人更易阅读。

> 与`C++`不同，`Java`没有任何无符号的整型类型。但是`Integer`和`Long`类都提供了处理无符号除法等的方法。

#### 浮点类型
- `Java`提供两种浮点类型：`double(8 bytes)`和`float(4 bytes)`
- `float`类型的精度只有6-7位，所以一般都使用`double`，因此`float`类型需要后缀`F(f)`，而`D(d)`一般可以省略。
- 三种表示溢出和出错的特殊浮点数值：`Double.POSITIVE_INFINITY`、`Double.NEGATIVE_INFINITY`、`Double.NaN`，分别代表正无穷、负无穷和不是一个数字。
    - 例如，整数除以0为正无穷大，`0/0`或者负数的平方根为`NaN`

!!! important "注意！"
    1. 不能使用`if(x == Double.NaN)`来判断一个特定值，因为所有的**“非数值”**都是不相等的，但可以使用`Double.isNaN(x)`方法来判断。
    2. `2.0-1.1 = 0.8999999···`而不是`0.9`，不允许舍入误差时应使用`BigDecimal`类。

#### `char`类型
- `char`类型用于表示单个字符，大小为2个字节，采用`Unicode`编码，范围为`\u0000`到`\uFFFF`。

!!! warning "转义字符会在代码解析之前得到处理！"
    `"\u0022+\u0022"`会被解析为`""+""`，即空字符串。

- 事实上`Java`的`char`类型已经不足以表示所有的单个字符了，因为`Unicode`字符已经超过了65536个。从`Java 5`开始引入了`U+10000 - U+10FFFF`的辅助字符，
  这也意味着有些特殊字符需要两个`char`类型来表示，这其中设计到两个重要的概念：码点和代码单元，可以参考[这个博客](https://blog.csdn.net/c1776167012/article/details/109147137)来理解。

!!! warning "码点和代码单元"
    通俗来讲，码点就是一个`Unicode`字符，而代码单元对于`Java`而言就是一个`char`数据类型。而在`Java`里，`String`类的所有基本方法（包括`length`、`charAt`等）都是
    对代码单元进行操作。所以当遇到特殊字符时，我们必须使用`codePointAt`等码点操作方法来确保我们处理的是一个完整的`Unicode`字符。

#### `boolean`类型
!!! warning "注意，在`Java`中整型值和布尔值不能相互转换"
    举一个简单的例子，`if (x=0) {···}`在`Java`中是无法编译运行的。

### 变量与常量
- `Java`变量名的命名规则在上文[命名规则](#命名规则)中已经提到过，不过需要额外强调的是，字母和数字表示的是各种语言中的字母和数字，而像`+`、`©`等字符是不允许出现的。

!!! tip "可以使用`Character`类的函数`isJavaIdentifierStart`和`isJavaIdentifierPart`函数来检查"

#### 变量初始化
对于以上的基本变量类型，在使用变量前必须对其进行显式初始化，因为其没有默认值，直接使用会产生编译错误

!!! tip "var 关键字"
    从`Java10`开始，对于**局部变量**，如果可以从变量的初始值推断出它的类型，就不需要声明类型而使用`var`关键字（类似`js`）

#### 常量
使用`final`关键字修饰常量，常量只能被赋值一次。类常量使用`static final`修饰。注意`const`是保留关键字但未被使用。

### 运算符

#### 算术运算符
共四个操作符：`+`、`-`、`*`、`/`，注意整除也使用`/`，且`/`仅在两个操作数均为整数时表示整除。

!!! important "除 0"
    有趣的是，整数除0会产生一个**异常**`ArithmeticException`，而浮点数除0则会得到`Infinity`、`-Infinity`或`NaN`（0.0/0）

#### 数学函数与常量
`Java`中没有幂运算，需要使用`Math`类的`pow`方法，其返回一个`double`类型对象

---

## 对象和类

---

## 继承

---

## 接口、lambda表达式与内部类

---

## 异常、断言和日志

---

## 泛型

---

## 集合

---

## 并发